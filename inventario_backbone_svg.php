<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<body>
<?php
include("includes.php");
?>
<svg width="3700" height="4100">

<polyline points="880,80 880,260" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1100,80 860,260" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="990,80 870,260" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="760,270 1960,270 1960,970 1600,970" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="850,300 850,450 1350,450" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1370,450 1770,450 1770,300" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1370,450 1370,620 1550,620" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1550,620 1950,620" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1540,610 1540,980" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1100,950 1100,840 1390,840 1390,700 1540,620" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1550,970 910,970 910,1270" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="900,1170 1200,1170" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1550,1000 1550,1080 1210,1080 1210,1180" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="910,1290 910,1440 1440,1440" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1440,1440 2300,1440 2300,2630 910,2630" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="880,2620 880,2930 1630,2930 1630,2650" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="900,2620 900,2770 1100,2770" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="900,2950 900,2785 1100,2785" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1650,2630 1650,2800 1750,2800" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="900,2690 830,2690 830,3000 1650,3000 1650,2820 1800,2820" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,250 150,250 150,2650 750,2650" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,2650 750, 3220 750, 3220" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,2650 900,2650" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,3220 750,3650" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="800,3670 1800,3670" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1760,3670 1760,3200" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1760,3200 1760,2800" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1760,3200 1940,3200 1940,2800 1760,2800" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1790,3670 1790,3550 2240,3550 2240,3350 1790,3350 1790,3200" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="800,3690 900,3690 900,3950 1640,3950 1640,3690 1800,3690" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1200,1170 2050,1170" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="2050,1170 1850,1170" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1860,1150 1940,1070" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1860,1190 1950,1270" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="2050,1170 2250,1170" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="2040,1200 2040,1270" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="2060,1190 2150,1270" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="2240,1200 2240,1270" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="890,300 890,310 240,310 240,2590 910,2590 910,2650" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="900,1440 400,1440 400,900 750,900 750,1290 850,1290" fill="none" stroke="#000000" stroke-width="8" />

 <polyline points="1500,1290 1600,1350 1810,1350 1810,1240 1600,1240 1500,1290" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1210,1180 1700,1180 1700,1250" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1630,1320 1700,1250" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1180,1190 1510,1190 1510,1290 900,1290" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="640,900 640,500" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,900 750,700" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="730,800 830,800" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="730,700 830,700" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="750,700 750,600" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1430,1450 1540,1650 1430,1650 1430,1450" fill="none" stroke="#cccccc" stroke-width="8" />

 <polyline points="1400,1450 1400,1600 585, 1605 585, 1785 " fill="none" stroke="#cccccc" stroke-width="8" /><!--AJU <> RIBEIRA-->

 <polyline points="1430,1650 1430,1720 2040,1720 2040,1800" fill="none" stroke="#cccccc" stroke-width="8" /><!--AJU_GVT <> SIRIRIZINHO-->

 <polyline points="600, 1800 2050,1800" fill="none" stroke="#cccccc" stroke-width="8" /> <!--RIBEIRA <> SIRIRIZINHO-->

 <polyline points="790, 1800 790, 1900" fill="none" stroke="#cccccc" stroke-width="8" /> <!--itabaiana <> SAO DOMINGOS-->

 <polyline points="790, 1900 790, 2000" fill="none" stroke="#cccccc" stroke-width="8" /> <!--SAO DOMINGOS <> LAGARTO CEN-->

 <polyline points="790, 1800 790, 2000" fill="none" stroke="#cccccc" stroke-width="8" /> <!--ITABAIANA <> SALGADO ZON-->

 <polyline points="585, 1800 330, 1970"fill="none" stroke="#cccccc" stroke-width="8" /><!--RIBEIRA <> SIMAO DIAS-->

 <polyline points="440, 1900 440, 2100" fill="none" stroke="#cccccc" stroke-width="8" /><!--PURURUCA <> PARIPIRANGA-->

 <polyline points="2020, 1800 2200, 1800" fill="none" stroke="#cccccc" stroke-width="8" /> <!--SIRIRIZINHO <> SIRIRI_FJU-->

 <polyline points="2055, 1800 2130, 1970" fill="none" stroke="#cccccc" stroke-width="8" /> <!--SIRIRIZINHO <> MALHADOR-->

 <polyline points="2025, 1800 1960, 1980" fill="none" stroke="#cccccc" stroke-width="8" /> <!--SIRIRIZINHO <> CARMOPOLIS-->

 <polyline points="2100, 1950 2220, 1950" fill="none" stroke="#cccccc" stroke-width="8" /> <!--MALHADOR <> AREIA BRANCA-->

 <polyline points="1980, 1950 1980, 2080" fill="none" stroke="#cccccc" stroke-width="8" /> <!--CARMOPOLIS <> JAPARATUBA_CEN-->

 <polyline points="1980, 1950 2100, 2070" fill="none" stroke="#cccccc" stroke-width="8" /> <!--CARMOPOLIS <> CAPELA-->

 <polyline points="1980, 1950 1865, 2060" fill="none" stroke="#cccccc" stroke-width="8" /> <!--CARMOPOLIS <> PIRAMBU_CEN-->

 <polyline points="1440,1800 1440,1930" fill="none" stroke="#cccccc" stroke-width="8" /> <!--JENIPAPO <> NOSSA SENHORA DA GLORIA_SBA-->

 <polyline points="1432, 1920 1363, 2080" fill="none" stroke="#cccccc" stroke-width="8" /> <!--NOSSA SENHORA DA GLORIA_SBA <> GRACHO CARDOSO -->

 <polyline points="1456, 1920 1505, 2090" fill="none" stroke="#cccccc" stroke-width="8" /> <!--NOSSA SENHORA DA GLORIA_SBA <> PORTO DA FOLHA REPETIDORA -->

 <polyline points="1430, 1930 1610, 1930" fill="none" stroke="#cccccc" stroke-width="8" /> <!--NOSSA SENHORA DA GLORIA_SBA <> SAO MIGUEL DO ALEIXO_CEN -->

 <polyline points="1635, 1930 1683, 2080" fill="none" stroke="#cccccc" stroke-width="8" /> <!--SAO MIGUEL DO ALEIXO_CEN <> NOSSA SENHORA APARECIDA_CEN -->

 <polyline points="1350, 2080 1350, 2210" fill="none" stroke="#cccccc" stroke-width="8" /> <!--GRACHO CARDOSO <> CUMBE -->

 <polyline points="1350, 2080 1230, 2220" fill="none" stroke="#cccccc" stroke-width="8" /> <!--GRACHO CARDOSO <> FEIRA NOVA -->

 <polyline points="1520, 2075 1520, 2230" fill="none" stroke="#cccccc" stroke-width="8" /> <!--PORTO DE FOLHA REPETIDORA <> PORTO DA FOLHA -->

 <polyline points="1520, 1650 1830, 1650" fill="none" stroke="#cccccc" stroke-width="8" /> <!--ARACAJU_TIM <> MORRO R6 -->

 <polyline points="1710, 1630 1830, 1565" fill="none" stroke="#cccccc" stroke-width="8" /> <!--URUBU <> LARANJEIRAS -->

 <polyline points="590, 1800 450, 1800"fill="none" stroke="#000000" stroke-width="8" /><!--RIBEIRA <> CAMPO DO BRITO-->

 <polyline points="790, 1800 690, 1900"fill="none" stroke="#CCCCCC" stroke-width="8" /><!--ITABAIANA <> MOITA BONITA-->

 <polyline points="790, 1800 890, 1900"fill="none" stroke="#CCCCCC" stroke-width="8" /><!--ITABAIANA <> MACAMBIRA-->

 <polyline points="890, 1900 890, 2020"fill="none" stroke="#CCCCCC" stroke-width="8" /><!--ITABAIANA <> PEDRA MOLE-->

 <polyline points="590, 1800  590, 2000 "fill="none" stroke="#cccccc" stroke-width="8" /><!--RIBEIRA <> LAGARTO_COL13-->

 <polyline points="590, 2000 590, 2100"fill="none" stroke="#cccccc" stroke-width="8" /><!--LAGARTO_COL13 <> PEDRINHAS_CEN-->
 <polyline points="590, 2000 690, 2100"fill="none" stroke="#cccccc" stroke-width="8" /><!--LAGARTO_COL13 <> SALGADO_ZON-->

 <polyline points="590, 2100 590, 2200"fill="none" stroke="#cccccc" stroke-width="8" /><!--PEDRINHAS_CEN <> ITABAIANINHA_CEN-->

 <polyline points="690, 2100  690, 2300"fill="none" stroke="#cccccc" stroke-width="8" /><!--PEDRINHAS_CEN <> TOBIAS BARRETO-->

 <polyline points="1110, 1800 1050, 1900"fill="none" stroke="#CCCCCC" stroke-width="8" /><!--RIBEIROPOLIS <> CARIRA_CEN-->

 <polyline points="1130, 1800 1200, 1900"fill="none" stroke="#cccccc" stroke-width="8" /><!--RIBEIROPOLIS <> FREI PAULO-->

 <polyline points="600, 1800 600,1700 1125,1700 1125,1800 "fill="none" stroke="#cccccc" stroke-width="8" /><!--RIBEIRA <> RIBEIROPOLIS-->

<?php

$query = "select id, coordenada, estacao, tipo from automacao_estacoes";
$resultado = fct_consulta($query);
while ($registro = mysqli_fetch_array($resultado)) {

  $id = $registro['id'];
  $coordenada = $registro['coordenada'];
  $estacao = $registro['estacao'];
  $tipo = $registro['tipo'];

  switch ($tipo) {
    case 2:
        $tamanho = '80';
        $text_x = '50';
        $text_y = '110';
        $contador = 8;
        break;
    case 3:
        $tamanho = '60';
        $text_x = '40';
        $text_y = '90';
        $contador = 6;
        break;
    default:
        $tamanho = '100';
        $text_x = '60';
        $text_y = '130';
        $contador = 11;
        break;
  }

print <<<END

<g transform="translate($coordenada)" id="$id" >
<rect x="10" y="20" width="$tamanho" height="$tamanho" fill="#CCCCCC" />
<text x="$text_x" y="$text_y" text-anchor="middle" font-size="10">$estacao</text>

END;

/*
$query2 = "select Modelo, ip, hostid from automacao_hosts where id_estacao = '$id'";
$resultado2 = fct_consulta($query2);
$posicao_x = 9;
$count = 0;
$posicao_y = 30;

while ($registro2 = mysqli_fetch_array($resultado2)) {
  $modelo = $registro2["Modelo"];
  $ip = $registro2["ip"];
  $hostid = $registro2["hostid"];
  $posicao_x = $posicao_x + 8;
  if ($count >= $contador) {
    $posicao_y = $posicao_y + 8;
    $posicao_x = 17;
    $count = 0;
  }

  echo "<a href='http://10.5.1.58/zabbix/zabbix.php?action=charts.view&view_as=showgraph&filter_hostids%5B%5D=$hostid&filter_set=1'><rect x='$posicao_x' y='$posicao_y' width='5' height='5' fill='green'><title>$modelo [$ip]</title></rect></a>";
  $count++;
}
*/
print <<<END
</g>
END;

}

?>
</svg>

<script type="text/javascript">
async function buscarElementos() {
  const response = await fetch('http://localhost:8000/busca-hosts.php');
  const elementos = await response.json();

  elementos.forEach(elemento => {
    // Localize o elemento SVG correspondente usando o ID
    const svgElemento = document.getElementById(elemento.parent_id);

    // Crie um novo elemento SVG para o elemento do banco de dados
    const novoElemento = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    novoElemento.setAttribute('x', elemento.x);
    novoElemento.setAttribute('y', elemento.y);
    novoElemento.setAttribute('width', elemento.width);
    novoElemento.setAttribute('height', elemento.height);
    novoElemento.setAttribute('fill', elemento.color);

    // Adicione o novo elemento ao elemento SVG correspondente
    svgElemento.appendChild(novoElemento);
  });
}

buscarElementos();
</script>

</body>